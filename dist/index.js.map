{"version":3,"sources":["/src/index.ts","/src/components/index.ts","/src/components/trade/index.ts","/src/components/trade/model.ts","/src/models/position.ts","/src/components/trade/intent.ts","/src/components/trade/request.ts","/src/http.ts","/src/components/trade/view.ts","/src/components/setting/index.ts","/src/components/setting/model.ts","/src/components/setting/view.ts","/src/components/setting/intent.ts","/src/drivers/pubnubDriver.ts"],"names":[],"mappings":";;;;;;AAAA,oCAAyC;AACzC,4CAAgE;AAChE,sCAA2C;AAC3C,oCAA+B;AAC/B,mDAAsC;AACtC,iDAAwC;AACxC,6CAAqC;AACrC,8CAAwC;AACxC,4CAA2C;AAC3C,yDAAwD;AAExD,SAAG,CAAC,yBAAS,CAAC,wBAAQ,CAAC,YAAI,CAAC,EAAE,qBAAU,CAAC,EAAE;IACvC,GAAG,EAAE,mBAAa,CAAC,MAAM,CAAC;IAC1B,IAAI,EAAE,qBAAc,EAAE;IACtB,OAAO,EAAE,uBAAa,CAAC,2BAAiB,EAAE,CAAC;IAC3C,MAAM,EAAE,+BAAgB,EAAE;IAC1B,OAAO,EAAE,iBAAa;CACzB,CAAC,CAAC;;;;;;;ACjBH,oCAAgE;AAEhE,4CAAqC;AAIrC,yCAAoC;AACpC,2CAAwC;AAqB3B,QAAA,IAAI,GAAG,CAAC,OAAgB,EAAS,EAAE;IAC5C,MAAM,OAAO,GAAG,OAAO,CAAC,MAAM;SACzB,MAAM,CAAC;QACJ,GAAG,EAAE,iBAAO,CAAC,aAAK,EAAE,EAAE,GAAG,EAAE,OAAO,EAAE,CAAC;QACrC,UAAU,EAAE,iBAAO,CAAC,eAAO,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE,CAAC;KACnD,CAAC;SACD,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,mBAAK,OAAO,IAAE,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAE,CAAC,CAAC;IAEtF,MAAM,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE;SAC3D,GAAG,CAAC,UAAU,CAAC,EAAE,CACV,SAAG,CAAC,UAAU,EAAE;QACZ,YAAM,CAAC,SAAS,EAAE;YACd,SAAG,CAAC,iBAAiB,EAAE;gBACnB,QAAE,CAAC,eAAe,EAAE,aAAa,CAAC;gBAClC,OAAC,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,OAAO,CAAC;gBACnD,OAAC,CAAC,eAAe,EAAE,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,UAAU,EAAE,EAAE,EAAE,SAAS,CAAC;aACjE,CAAC;SACL,CAAC;QACF,SAAG,CAAC,UAAU,EAAE,CAAC,UAAU,CAAC,CAAC;KAChC,CAAC,CACL,CAAC;IAEV,MAAM,CAAC;QACH,GAAG,EAAE,KAAK;QACV,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE;QACzD,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE;QAC3D,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,OAAO,EAAE;QAC7D,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,OAAO,EAAE;KAClE,CAAC;AACN,CAAC,CAAC;;;;;;;ACtDF,qCAA6B;AAC7B,mCAA8B;AAI9B,qCAAgC;AAChC,uCAAkC;AAClC,iCAA4B;AAmBf,QAAA,KAAK,GAAG,CAAC,OAAgB,EAAS,EAAE;IAC7C,MAAM,OAAO,GAAG,eAAM,CAAC,OAAO,CAAC,CAAC;IAChC,MAAM,QAAQ,GAAG,aAAK,CAAC,OAAO,CAAC,CAAC;IAChC,MAAM,KAAK,GAAG,WAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACzC,MAAM,QAAQ,GAAG,iBAAO,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IAExD,MAAM,CAAC;QACH,GAAG,EAAE,KAAK;QACV,IAAI,EAAE,QAAQ;QACd,KAAK,EAAE,QAAQ;QACf,MAAM,EAAE,iBAAM,CAAC,KAAK,EAAE;QACtB,OAAO,EAAE,iBAAM,CAAC,KAAK,EAAE;KAC1B,CAAA;AACL,CAAC,CAAC;;;;;;;ACzCF,qCAA6B;AAC7B,qDAA8C;AAE9C,oDAA+C;AAW/C,MAAM,YAAY,GAAU;IACxB,UAAU,EAAE,GAAG;IACf,YAAY,EAAE,CAAC;IACf,UAAU,EAAE,KAAK;IACjB,QAAQ,EAAE,IAAI,mBAAQ,CAAC,EAAE,CAAC;IAC1B,IAAI,EAAE,CAAC;IACP,WAAW,EAAE,EAAE;CAClB,CAAC;AAEW,QAAA,KAAK,GAAG,CAAC,OAAgB,EAA0B,EAAE;IAC9D,MAAM,eAAe,GAAG,iBAAM,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,OAAO,KAAK,KAAK,WAAW,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IAEzG,MAAM,kBAAkB,GAAG,OAAO,CAAC,mBAAmB;SACjD,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,UAAU,IAAG,CAAC,CAAC;IAErE,MAAM,oBAAoB,GAAG,OAAO,CAAC,mBAAmB;SACnD,OAAO,CAAC,kBAAQ,CAAC,GAAG,CAAC,CAAC;SACtB,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC;SACjC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,YAAY,IAAG,CAAC,CAAC;IAEzE,MAAM,kBAAkB,GAAG,iBAAM,CAAC,KAAK,CACnC,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,EACtC,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,EACtC,OAAO,CAAC,mBAAmB,CAAC,KAAK,CAAC,IAAI,CAAC,EACvC,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,KAAK,CAAC,CACvC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,UAAU,IAAG,CAAC,CAAC;IAElE,MAAM,iBAAiB,GAAG,OAAO,CAAC,kBAAkB;SAC/C,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,mBAAQ,CAAC,SAAS,CAAC,CAAC;SACzC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,QAAQ,IAAG,CAAC,CAAC;IAEjE,MAAM,YAAY,GAAG,OAAO,CAAC,cAAc;SACtC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,IAAI,IAAE,CAAC,CAAC;IAExD,MAAM,mBAAmB,GAAG,OAAO,CAAC,cAAc;SAC7C,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,WAAW,IAAE,CAAC,CAAC;IAEtE,MAAM,CAAC,iBAAM,CAAC,KAAK,CACf,eAAe,EACf,kBAAkB,EAClB,oBAAoB,EACpB,kBAAkB,EAClB,iBAAiB,EACjB,YAAY,EACZ,mBAAmB,CACtB,CAAC;AACN,CAAC,CAAC;;;;;;;AC7DF;IAKI,YAAY,SAAmB;QAC3B,EAAE,CAAC,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;YACf,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;YACf,MAAM,CAAA;QACV,CAAC;QAED,MAAM,IAAI,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,QAAQ,EAAE,EAAE,CAAC,GAAG,GAAG,QAAQ,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QAC3E,MAAM,QAAQ,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,QAAQ,EAAE,EAAE,CAAC,GAAG,GAAI,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QAEjG,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC9B,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAClE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC;IAC7D,CAAC;IAEM,MAAM,CAAC,YAAoB;QAC9B,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC/E,CAAC;IAEM,QAAQ;QACX,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QACpC,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,MAAM,IAAI,CAAC,IAAI,EAAE,CAAA;IAC1D,CAAC;IAAA,CAAC;IAEK,YAAY,CAAC,YAAoB;QACpC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QACpC,MAAM,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,cAAc,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;IAC3E,CAAC;IAAA,CAAC;IAEK,cAAc,CAAC,YAAoB;QACtC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QACpC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,cAAc,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;IACzE,CAAC;IAAA,CAAC;IAEM,MAAM,CAAC,KAAK,CAAC,MAAc;QAC/B,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,SAAS,CAAC,GAAG,SAAS,CAAC;IACtD,CAAC;CACJ;AA3CD,4BA2CC;;;;;;;AC1BY,QAAA,MAAM,GAAG,CAAC,OAAgB,EAAW,EAAE;IAChD,MAAM,eAAe,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;SAC3D,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,IAAI,MAAM,KAAK,EAAE,CAAC;SACzC,IAAI,CAAC,CAAC,CAAC,CAAC;IAEb,MAAM,kBAAkB,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC;SACjE,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,IAAI,SAAS,KAAK,EAAE,CAAC;SAClD,IAAI,CAAC,CAAC,CAAC,CAAC;IAEb,MAAM,iBAAiB,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,aAAa,CAAC;SACtD,MAAM,CAAC,OAAO,EAAE,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC;SACzC,KAAK,CAAC,IAAI,CAAC,CAAC;IAEjB,MAAM,mBAAmB,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,eAAe,CAAC;SAC1D,MAAM,CAAC,OAAO,EAAE,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC;SACzC,KAAK,CAAC,IAAI,CAAC,CAAC;IAEjB,MAAM,kBAAkB,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,cAAc,CAAC;SACxD,MAAM,CAAC,OAAO,EAAE,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC;SACzC,KAAK,CAAC,IAAI,CAAC,CAAC;IAEjB,MAAM,mBAAmB,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC;SACxD,OAAO,EAAE;SACT,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,CAAC;IAE3D,MAAM,mBAAmB,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC;IAEtD,MAAM,eAAe,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;SAC/C,OAAO,EAAE;SACT,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;IAEhD,MAAM,kBAAkB,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC;SACtD,OAAO,EAAE;SACT,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;IAEhD,MAAM,cAAc,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,aAAa,CAAC;SACnD,MAAM,CAAC,OAAO,CAAC;SACf,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAA0B,CAAC;SAC9C,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAEpC,MAAM,cAAc,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;SAC/C,OAAO,EAAE;SACT,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;IAEhD,MAAM,CAAC;QACH,eAAe;QACf,kBAAkB;QAClB,iBAAiB;QACjB,mBAAmB;QACnB,kBAAkB;QAClB,mBAAmB;QACnB,mBAAmB;QACnB,eAAe;QACf,kBAAkB;QAClB,cAAc;QACd,cAAc;KACjB,CAAC;AACN,CAAC,CAAC;;;;;;;ACzEF,qCAA6B;AAC7B,+DAAwD;AAExD,qCAA8E;AAGjE,QAAA,OAAO,GAAG,CAAC,OAAgB,EAAE,MAAqB,EAAwB,EAAE;IACrF,MAAM,UAAU,GAAG,iBAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,oBAAa,EAAE,CAAC,CAAC,SAAS,CAAC,oBAAa,EAAE,CAAC,CAAC;IAC5F,MAAM,SAAS,GAAG,iBAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,mBAAY,EAAE,CAAC,CAAC,SAAS,CAAC,mBAAY,EAAE,CAAC,CAAC;IACxF,MAAM,KAAK,GAAG,iBAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,eAAQ,EAAE,CAAC,CAAC,SAAS,CAAC,eAAQ,EAAE,CAAC,CAAC;IAE5E,MAAM,GAAG,GAAG,OAAO,CAAC,iBAAiB;SAChC,OAAO,CAAC,uBAAa,CAAC,MAAM,CAAC,CAAC;SAC9B,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,kBAAW,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;IAEzD,MAAM,IAAI,GAAG,OAAO,CAAC,kBAAkB;SAClC,OAAO,CAAC,uBAAa,CAAC,MAAM,CAAC,CAAC;SAC9B,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,kBAAW,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC;IAE1D,MAAM,KAAK,GAAG,OAAO,CAAC,mBAAmB;SACpC,OAAO,CAAC,uBAAa,CAAC,MAAM,CAAC,CAAC;SAC9B,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,kBAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;IAE3G,MAAM,CAAC,iBAAM,CAAC,KAAK,CAAC,UAAU,EAAE,SAAS,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;AACxE,CAAC,CAAC;;;;;;;ACzBF,gCAAiC;AAGpB,QAAA,QAAQ,GAAG,GAAiB,EAAE,CACvC,YAAY,CAAC,QAAQ,EAAE,mBAAmB,EAAE,KAAK,CAAC,CAAC;AAE1C,QAAA,aAAa,GAAG,GAAiB,EAAE,CAC5C,YAAY,CAAC,YAAY,EAAE,sBAAsB,EAAE,KAAK,CAAC,CAAC;AAEjD,QAAA,YAAY,GAAG,GAAiB,EAAE,CAC3C,YAAY,CAAC,WAAW,EAAE,qBAAqB,EAAE,KAAK,CAAC,CAAC;AAE/C,QAAA,WAAW,GAAG,CAAC,IAAY,EAAE,IAAY,EAAgB,EAAE;IACpE,MAAM,IAAI,GAAG;QACT,cAAc,EAAE,YAAY;QAC5B,kBAAkB,EAAE,QAAQ;QAC5B,MAAM,EAAE,IAAI;QACZ,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;KACzB,CAAC;IACF,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,uBAAuB,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AACxE,CAAC,CAAC;AAEF,MAAM,YAAY,GAAG,CAAC,QAAgB,EAAE,IAAY,EAAE,MAAc,EAAE,IAAa,EAAE,EAAE;IACnF,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,UAAU,EAAE,CAAC;IAEnC,MAAM,GAAG,GAAG,0BAA0B,IAAI,EAAE,CAAC;IAC7C,MAAM,KAAK,GAAG,EAAE,YAAY,EAAE,YAAY,EAAE,CAAC;IAC7C,MAAM,WAAW,GAAG,0BAA0B,CAAC;IAE/C,MAAM,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;IAC9C,MAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC;IAExC,MAAM,OAAO,GAAG;QACZ,YAAY,EAAE,GAAG;QACjB,kBAAkB,EAAE,SAAS;QAC7B,aAAa,EAAE,SAAS,CAAC,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,WAAW,CAAC;QACtF,cAAc,EAAE,kBAAkB;KACrC,CAAC;IAEF,MAAM,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;AAC3D,CAAC,CAAC;AAEF,MAAM,UAAU,GAAG,GAAa,EAAE;IAC9B,MAAM,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC,CAAC;AACjE,CAAC,CAAC;AAEF,MAAM,SAAS,GAAG,CACd,GAAW,EACX,MAAc,EACd,GAAW,EACX,MAAc,EACd,SAAiB,EACjB,IAAY,EACZ,IAAY,EACZ,KAAa,EACP,EAAE;IACR,MAAM,IAAI,GAAG,SAAS,GAAG,MAAM,GAAG,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC;IACtD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AACrE,CAAC,CAAC;;;;;;;AC1DF,oCAAmE;AAItD,QAAA,IAAI,GAAG,CAAC,MAAqB,EAAE,EAAE,CAC1C,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CACf,SAAG,CAAC,QAAQ,EAAE;IACV,SAAG,CAAC,UAAU,EAAE;QACZ,QAAE,CAAC,QAAQ,EAAE,SAAS,CAAC;QACvB,SAAG,CAAC,gBAAgB,EAAE;YAClB,UAAI,CAAC,QAAQ,EAAE,eAAe,CAAC;YAC/B,UAAI,CAAC,SAAS,EAAE,KAAK,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC;YACpD,UAAI,CAAC,OAAO,EAAE,KAAK,CAAC;SACvB,CAAC;QACF,SAAG,CAAC,WAAW,EAAE;YACb,UAAI,CAAC,QAAQ,EAAE,UAAU,CAAC;YAC1B,UAAI,CAAC,SAAS,EAAE,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;SAC7C,CAAC;QACF,SAAG,CAAC,gBAAgB,EAAE;YAClB,UAAI,CAAC,QAAQ,EAAE,qBAAqB,CAAC;YACrC,UAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;YACnF,UAAI,CAAC,OAAO,EAAE,KAAK,CAAC;SACvB,CAAC;QACF,SAAG,CAAC,SAAS,EAAE;YACX,UAAI,CAAC,QAAQ,EAAE,eAAe,CAAC;YAC/B,UAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;YAC3E,UAAI,CAAC,OAAO,EAAE,KAAK,CAAC;SACvB,CAAC;QACF,SAAG,CAAC,aAAa,EAAE;YACf,UAAI,CAAC,QAAQ,EAAE,YAAY,CAAC;YAC5B,UAAI,CAAC,SAAS,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC;YACxC,UAAI,CAAC,OAAO,EAAE,KAAK,CAAC;SACvB,CAAC;QACF,QAAE,EAAE;QACJ,SAAG,CAAC,eAAe,EAAE;YACjB,UAAI,CAAC,QAAQ,EAAE,cAAc,CAAC;YAC9B,UAAI,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC;SACxE,CAAC;QACF,SAAG,CAAC,cAAc,EAAE;YAChB,UAAI,CAAC,QAAQ,EAAE,aAAa,CAAC;YAC7B,UAAI,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC;SACtE,CAAC;KACL,CAAC;IACF,SAAG,CAAC,QAAQ,EAAE;QACV,QAAE,CAAC,QAAQ,EAAE,OAAO,CAAC;QACrB,QAAE,EAAE;QACJ,QAAE,CAAC,YAAY,EAAE,MAAM,CAAC;QACxB,SAAG,CAAC,OAAO,EAAE;YACT,WAAK,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,IAAI,EAAE,EAAC,CAAC;SACxD,CAAC;QACF,QAAE,EAAE;QACJ,QAAE,CAAC,YAAY,EAAE,QAAQ,CAAC;QAC1B,SAAG,CAAC,gBAAgB,EAAE;YAClB,YAAM,CAAC,cAAc,EAAE,EAAE,KAAK,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,UAAU,EAAE,EAAE,EAAE,MAAM,CAAC;YACzE,YAAM,CAAC,aAAa,EAAE,EAAE,KAAK,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,UAAU,EAAE,EAAE,EAAC,KAAK,CAAC;SACzE,CAAC;QACF,QAAE,EAAE;QACJ,QAAE,CAAC,YAAY,EAAE,gBAAgB,CAAC;QAClC,SAAG,CAAC,gBAAgB,EAAE;YAClB,YAAM,CAAC,eAAe,EAAE,EAAE,KAAK,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,UAAU,EAAE,EAAE,EAAE,OAAO,CAAC;SAC9E,CAAC;KACL,CAAC;CACL,CAAC,CACL,CAAC;AAEN,MAAM,gBAAgB,GAAG,CAAC,KAAK,EAAU,EAAE;IACvC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;QAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;IACpE,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;IACzD,MAAM,CAAC,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC,CAAC,cAAc,EAAE,CAAC;AACxD,CAAC,CAAC;AAEF,MAAM,WAAW,GAAG,CAAC,KAAK,EAAU,EAAE;IAClC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;QAAC,MAAM,CAAC,SAAS,CAAC;IAC5C,EAAE,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC;QAChC,MAAM,CAAC,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,IAAI,GAAG,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,eAAe,CAAC;IAC/F,CAAC;IAAC,IAAI,CAAC,CAAC;QACJ,MAAM,CAAC,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,IAAI,GAAG,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,cAAc,CAAC;IAC/F,CAAC;AACL,CAAC,CAAC;AAEF,MAAM,qBAAqB,GAAG,CAAC,KAAK,EAAU,EAAE;IAC5C,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;QAAC,MAAM,CAAC,SAAS,CAAC;IAC5C,MAAM,CAAC,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,IAAI,GAAG,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,eAAe,CAAC;AAC/F,CAAC,CAAC;AAEF,MAAM,WAAW,GAAG,CAAC,MAAc,EAAU,EAAE;IAC3C,EAAE,CAAC,CAAC,MAAM,KAAK,QAAQ,IAAI,MAAM,KAAK,SAAS,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,cAAc,CAAC;IAC1B,CAAC;IAAC,IAAI,CAAC,CAAC;QACJ,MAAM,CAAC,aAAa,CAAC;IACzB,CAAC;AACL,CAAC,CAAC;;;;;;;ACvFF,qCAA6B;AAC7B,mCAA8B;AAE9B,iCAA4B;AAC5B,qCAAgC;AAkBnB,QAAA,OAAO,GAAG,CAAC,OAAgB,EAAS,EAAE;IAC/C,MAAM,OAAO,GAAG,eAAM,CAAC,OAAO,CAAC,CAAC;IAChC,MAAM,QAAQ,GAAG,aAAK,CAAC,OAAO,CAAC,CAAC;IAChC,MAAM,KAAK,GAAG,WAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACzC,MAAM,QAAQ,GAAG,iBAAM,CAAC,KAAK,CACzB,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,CAAC,MAAM,EAAC,CAAC,CAAC,EAC3E,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,YAAY,EAAE,KAAK,EAAE,KAAK,CAAC,SAAS,EAAC,CAAC,CAAC,CACpF,CAAC;IAEF,MAAM,CAAC;QACH,GAAG,EAAE,KAAK;QACV,IAAI,EAAE,iBAAM,CAAC,KAAK,EAAE;QACpB,KAAK,EAAE,QAAQ;QACf,MAAM,EAAE,iBAAM,CAAC,KAAK,EAAE;QACtB,OAAO,EAAE,QAAQ;KACpB,CAAA;AACL,CAAC,CAAC;;;;;;;ACzCF,qCAA6B;AAQ7B,MAAM,YAAY,GAAU;IACxB,MAAM,EAAE,EAAE;IACV,SAAS,EAAE,EAAE;CAChB,CAAC;AAEW,QAAA,KAAK,GAAG,CAAC,OAAgB,EAA0B,EAAE;IAC9D,MAAM,eAAe,GAAG,iBAAM,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,OAAO,KAAK,KAAK,WAAW,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IAEzG,MAAM,cAAc,GAAG,iBAAM,CAAC,KAAK,CAAC,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,qBAAqB,CAAC;SACtF,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,MAAM,IAAG,CAAC,CAAC;IAE7D,MAAM,iBAAiB,GAAG,iBAAM,CAAC,KAAK,CAAC,OAAO,CAAC,kBAAkB,EAAE,OAAO,CAAC,wBAAwB,CAAC;SAC/F,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,KAAY,EAAE,EAAE,CAAC,mBAAM,KAAK,IAAE,SAAS,IAAG,CAAC,CAAC;IAEnE,MAAM,CAAC,iBAAM,CAAC,KAAK,CACf,eAAe,EACf,cAAc,EACd,iBAAiB,CACpB,CAAC;AACN,CAAC,CAAC;;;;;;;AC5BF,oCAAwD;AAI3C,QAAA,IAAI,GAAG,CAAC,MAAqB,EAAiB,EAAE,CACzD,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CACf,SAAG,CAAC,UAAU,EAAE;IACZ,QAAE,CAAC,QAAQ,EAAE,SAAS,CAAC;IACvB,SAAG,CAAC,UAAU,EAAE;QACZ,WAAK,CAAC,EAAE,KAAK,EAAE,EAAE,GAAG,EAAE,eAAe,EAAE,EAAE,EAAE,SAAS,CAAC;QACrD,WAAK,CAAC,gBAAgB,EAAE,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC;KACvF,CAAC;IACF,SAAG,CAAC,aAAa,EAAE;QACf,WAAK,CAAC,EAAE,KAAK,EAAE,EAAE,GAAG,EAAE,kBAAkB,EAAE,EAAE,EAAE,YAAY,CAAC;QAC3D,WAAK,CAAC,mBAAmB,EAAE,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,SAAS,EAAE,EAAE,CAAC;KAC7F,CAAC;CACL,CAAC,CACL,CAAC;;;;;;;ACPO,QAAA,MAAM,GAAG,CAAC,OAAgB,EAAW,EAAE;IAChD,MAAM,eAAe,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;SAC3D,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,IAAI,MAAM,KAAK,EAAE,CAAC;SACzC,IAAI,CAAC,CAAC,CAAC,CAAC;IAEb,MAAM,kBAAkB,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC;SACjE,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,IAAI,SAAS,KAAK,EAAE,CAAC;SAClD,IAAI,CAAC,CAAC,CAAC,CAAC;IAEb,MAAM,qBAAqB,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,gBAAgB,CAAC;SAC7D,MAAM,CAAC,OAAO,CAAC;SACf,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAA0B,CAAC;SAC9C,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAEnC,MAAM,wBAAwB,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,mBAAmB,CAAC;SACnE,MAAM,CAAC,OAAO,CAAC;SACf,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAA0B,CAAC;SAC9C,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAEnC,MAAM,CAAC;QACH,eAAe;QACf,kBAAkB;QAClB,qBAAqB;QACrB,wBAAwB;KAC3B,CAAA;AACL,CAAC,CAAC;;;;;;;ACnCF,iCAAkC;AAClC,qCAA6B;AAEhB,QAAA,gBAAgB,GAAG,GAAG,EAAE,CAAC,GAAiB,EAAE;IACrD,MAAM,YAAY,GAAG,4CAA4C,CAAC;IAClE,MAAM,CAAC,IAAI,YAAY,CAAC,IAAI,MAAM,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,CAAC;AAC1D,CAAC,CAAC;AAEF;IAQI,YAAY,MAAc;QAPnB,mBAAc,GAAG,iBAAM,CAAC,MAAM,EAAE,CAAC;QACjC,WAAM,GAAG,iBAAM,CAAC,MAAM,EAAE,CAAC;QACzB,YAAO,GAAG,iBAAM,CAAC,MAAM,EAAE,CAAC;QAC1B,eAAU,GAAG,iBAAM,CAAC,MAAM,EAAE,CAAC;QAKhC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QAErB,MAAM,CAAC,WAAW,CAAC;YACf,OAAO,EAAE,CAAC,OAAO,EAAE,EAAE;gBACjB,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,KAAK,qCAAqC,CAAC,CAAC,CAAC;oBAC5D,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;gBAC5D,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,KAAK,4BAA4B,CAAC,CAAC,CAAC;oBAC1D,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;gBACpD,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,KAAK,6BAA6B,CAAC,CAAC,CAAC;oBAC3D,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;gBACrD,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,KAAK,iCAAiC,CAAC,CAAC,CAAC;oBAC/D,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC;gBACpF,CAAC;YACL,CAAC;YACD,QAAQ,EAAE,CAAC,QAAQ,EAAE,EAAE,CAAC,SAAS;YACjC,MAAM,EAAE,CAAC,MAAM,EAAE,EAAE,CAAC,SAAS;SAChC,CAAC,CAAC;QAEH,MAAM,CAAC,SAAS,CAAC;YACb,QAAQ,EAAE;gBACN,yCAAyC;gBACzC,gCAAgC;gBAChC,iCAAiC;gBACjC,iCAAiC;aACpC;SACJ,CAAC,CAAA;IACN,CAAC;CACJ;AApCD,oCAoCC","file":"","sourcesContent":["import {makeDOMDriver} from \"@cycle/dom\";\nimport {makeHistoryDriver, captureClicks} from \"@cycle/history\";\nimport {makeHTTPDriver} from \"@cycle/http\";\nimport {run} from \"@cycle/run\";\nimport onionify from \"cycle-onionify\";\nimport {routerify} from \"cyclic-router\";\nimport switchPath from \"switch-path\";\nimport {Root} from \"./components/index\";\nimport storageDriver from \"@cycle/storage\";\nimport {makePubnubDriver} from \"./drivers/pubnubDriver\";\n\nrun(routerify(onionify(Root), switchPath), {\n    DOM: makeDOMDriver(\"#app\"),\n    HTTP: makeHTTPDriver(),\n    history: captureClicks(makeHistoryDriver()),\n    pubnub: makePubnubDriver(),\n    storage: storageDriver\n});\n","import {a, div, DOMSource, h1, header, VNode} from \"@cycle/dom\";\nimport {HTTPSource, RequestInput} from \"@cycle/http\";\nimport isolate from \"@cycle/isolate\";\nimport {Reducer, StateSource} from \"cycle-onionify\";\nimport {HistoryAction, RouterSource} from \"cyclic-router\";\nimport Stream from \"xstream\";\nimport {Trade} from \"./trade/index\";\nimport {Setting} from \"./setting/index\";\nimport {StorageRequest, StorageSource} from \"@cycle/storage\";\nimport {PubnubSource} from \"../drivers/pubnubDriver\";\n\nexport interface Sources {\n    DOM: DOMSource;\n    HTTP: HTTPSource;\n    onion: StateSource<object>;\n    pubnub: PubnubSource;\n    router: RouterSource;\n    storage: StorageSource;\n}\n\nexport interface Sinks {\n    DOM: Stream<VNode>;\n    HTTP: Stream<RequestInput|null>;\n    onion: Stream<Reducer<object>>;\n    router: Stream<HistoryAction>;\n    storage: Stream<StorageRequest>;\n}\n\nexport const Root = (sources: Sources): Sinks => {\n    const routes$ = sources.router\n        .define({\n            \"/\": isolate(Trade, { \"*\": \"trade\" }),\n            \"/setting\": isolate(Setting, { \"*\": \"setting\" })\n        })\n        .map(route => route.value({...sources, router: sources.router.path(route.path)}));\n\n    const view$ = routes$.map((sinks: Sinks) => sinks.DOM).flatten()\n        .map(contentDOM =>\n                div(\"#wrapper\", [\n                    header(\".header\", [\n                        div(\".header-wrapper\", [\n                            h1(\".header-title\", \"cycle-flyer\"),\n                            a(\".menu-trade\", { props: { href: \"/\" } }, \"Trade\"),\n                            a(\".menu-setting\", { props: { href: \"/setting\" } }, \"Setting\")\n                        ])\n                    ]),\n                    div(\".content\", [contentDOM])\n                ])\n            );\n\n    return {\n        DOM: view$,\n        HTTP: routes$.map((sinks: Sinks) => sinks.HTTP).flatten(),\n        onion: routes$.map((sinks: Sinks) => sinks.onion).flatten(),\n        router: routes$.map((sinks: Sinks) => sinks.router).flatten(),\n        storage: routes$.map((sinks: Sinks) => sinks.storage).flatten()\n    };\n};\n","import {DOMSource, VNode} from \"@cycle/dom\";\nimport {HTTPSource, RequestInput} from \"@cycle/http\";\nimport {Reducer, StateSource} from \"cycle-onionify\";\nimport Stream from \"xstream\";\nimport {model} from \"./model\";\nimport {HistoryAction, RouterSource} from 'cyclic-router';\nimport {StorageRequest, StorageSource} from \"@cycle/storage\";\nimport {PubnubSource} from \"../../drivers/pubnubDriver\";\nimport {intent} from \"./intent\";\nimport {request} from \"./request\";\nimport {view} from \"./view\";\n\nexport interface Sources {\n    DOM: DOMSource;\n    HTTP: HTTPSource;\n    onion: StateSource<object>;\n    pubnub: PubnubSource;\n    router: RouterSource;\n    storage: StorageSource;\n}\n\nexport interface Sinks {\n    DOM: Stream<VNode>;\n    HTTP: Stream<RequestInput|null>;\n    onion: Stream<Reducer<object>>;\n    router: Stream<HistoryAction>;\n    storage: Stream<StorageRequest>;\n}\n\nexport const Trade = (sources: Sources): Sinks => {\n    const actions = intent(sources);\n    const reducer$ = model(actions);\n    const view$ = view(sources.onion.state$);\n    const request$ = request(actions, sources.onion.state$);\n\n    return {\n        DOM: view$,\n        HTTP: request$,\n        onion: reducer$,\n        router: Stream.empty(),\n        storage: Stream.empty()\n    }\n};\n","import {Reducer} from \"cycle-onionify\";\nimport Stream from \"xstream\";\nimport throttle from \"xstream/extra/throttle\";\nimport {Actions} from \"./intent\";\nimport {Position} from \"../../models/position\";\n\nexport interface State {\n    collateral: number;\n    currentPrice: number;\n    isOrdering: boolean;\n    position: Position;\n    size: number;\n    marketState: object;\n}\n\nconst defaultState: State = {\n    collateral: 0.0,\n    currentPrice: 0,\n    isOrdering: false,\n    position: new Position([]),\n    size: 0,\n    marketState: {}\n};\n\nexport const model = (actions: Actions): Stream<Reducer<State>> => {\n    const defaultReducer$ = Stream.of((state: State) => typeof state === \"undefined\" ? defaultState : state);\n\n    const collateralReducer$ = actions.onCollateralLoaded$\n        .map(collateral => (state: State) => ({ ...state, collateral }));\n\n    const currentPriceReducer$ = actions.onExecutionCreated$\n        .compose(throttle(100))\n        .map(execution => execution.price)\n        .map(currentPrice => (state: State) => ({ ...state, currentPrice }));\n\n    const isOrderingReducer$ = Stream.merge(\n        actions.onClickSellButton$.mapTo(true),\n        actions.onClickSellButton$.mapTo(true),\n        actions.onClickClearButton$.mapTo(true),\n        actions.onOrderCreated$.mapTo(false)\n    ).map(isOrdering => (state: State) => ({ ...state, isOrdering }));\n\n    const positionsReducer$ = actions.onPositionsLoaded$\n        .map(positions => new Position(positions))\n        .map(position => (state: State) => ({ ...state, position }));\n\n    const sizeReducer$ = actions.onSizeChanged$\n        .map(size => (state: State) => ({ ...state, size}));\n\n    const marketStateReducer$ = actions.onStateLoaded$\n        .map(marketState => (state: State) => ({ ...state, marketState}));\n\n    return Stream.merge(\n        defaultReducer$,\n        collateralReducer$,\n        currentPriceReducer$,\n        isOrderingReducer$,\n        positionsReducer$,\n        sizeReducer$,\n        marketStateReducer$\n    );\n};\n","export class Position {\n    public side: string;\n    public size: number;\n    public price: number;\n\n    constructor(positions: object[]) {\n        if (!positions || positions.length === 0) {\n            this.side = \"\";\n            this.size = 0;\n            this.price = 0;\n            return\n        }\n\n        const size = positions.reduce((acc, position) => acc + position.size, 0.0);\n        const priceSum = positions.reduce((acc, position) => acc +  position.price * position.size, 0.0);\n\n        this.side = positions[0].side;\n        this.size = Position.round(size * (this.side === \"BUY\" ? 1 : -1));\n        this.price = Math.floor(Position.round(priceSum / size));\n    }\n\n    public profit(currentPrice: number): number {\n        return Math.floor(Position.round((currentPrice - this.price) * this.size));\n    }\n\n    public toString(): string {\n        if (this.price === 0) return \"None\";\n        return `${this.price.toLocaleString()} / ${this.size}`\n    };\n\n    public toDiffString(currentPrice: number): string {\n        if (this.price === 0) return \"None\";\n        return (currentPrice - this.price).toLocaleString().replace(\"-\", \"- \");\n    };\n\n    public toProfitString(currentPrice: number): string {\n        if (this.price === 0) return \"None\";\n        return this.profit(currentPrice).toLocaleString().replace(\"-\", \"- \");\n    };\n\n    private static round(number: number): number {\n        return Math.round(number * 100000000) / 100000000;\n    }\n}\n","import {Sources} from \"./index\";\nimport {Stream} from 'xstream';\n\nexport interface Actions {\n    onApiKeyLoaded$: Stream<string>;\n    onApiSecretLoaded$: Stream<string>;\n    onClickBuyButton$: Stream<null>;\n    onClickClearButton$: Stream<null>;\n    onClickSellButton$: Stream<null>;\n    onCollateralLoaded$: Stream<number>;\n    onExecutionCreated$: Stream<object>;\n    onPositionsLoaded$: Stream<object[]>;\n    onOrderCreated$: Stream<object>;\n    onSizeChanged$: Stream<number>;\n    onStateLoaded$: Stream<object>;\n}\n\nexport const intent = (sources: Sources): Actions => {\n    const onApiKeyLoaded$ = sources.storage.local.getItem(\"api-key\")\n        .filter(apiKey => apiKey && apiKey !== \"\")\n        .take(1);\n\n    const onApiSecretLoaded$ = sources.storage.local.getItem(\"api-secret\")\n        .filter(apiSecret => apiSecret && apiSecret !== \"\")\n        .take(1);\n\n    const onClickBuyButton$ = sources.DOM.select(\".buy-button\")\n        .events(\"click\", { preventDefault: true })\n        .mapTo(null);\n\n    const onClickClearButton$ = sources.DOM.select(\".clear-button\")\n        .events(\"click\", { preventDefault: true })\n        .mapTo(null);\n\n    const onClickSellButton$ = sources.DOM.select(\".sell-button\")\n        .events(\"click\", { preventDefault: true })\n        .mapTo(null);\n\n    const onCollateralLoaded$ = sources.HTTP.select(\"collateral\")\n        .flatten()\n        .map(response => JSON.parse(response.text).collateral);\n\n    const onExecutionCreated$ = sources.pubnub.execution$;\n\n    const onOrderCreated$ = sources.HTTP.select(\"order\")\n        .flatten()\n        .map(response => JSON.parse(response.text));\n\n    const onPositionsLoaded$ = sources.HTTP.select(\"positions\")\n        .flatten()\n        .map(response => JSON.parse(response.text));\n\n    const onSizeChanged$ = sources.DOM.select(\"#size-input\")\n        .events(\"keyup\")\n        .map(event => event.target as HTMLInputElement)\n        .map(element => +element.value);\n\n    const onStateLoaded$ = sources.HTTP.select(\"status\")\n        .flatten()\n        .map(response => JSON.parse(response.text));\n\n    return {\n        onApiKeyLoaded$,\n        onApiSecretLoaded$,\n        onClickBuyButton$,\n        onClickClearButton$,\n        onClickSellButton$,\n        onCollateralLoaded$,\n        onExecutionCreated$,\n        onOrderCreated$,\n        onPositionsLoaded$,\n        onSizeChanged$,\n        onStateLoaded$\n    };\n};\n","import {RequestInput} from \"@cycle/http\";\nimport Stream from \"xstream\";\nimport sampleCombine from \"xstream/extra/sampleCombine\";\nimport {Actions} from \"./intent\";\nimport {getCollateral, getPositions, getState, marketOrder} from '../../http';\nimport {State} from \"./model\";\n\nexport const request = (actions: Actions, state$: Stream<State>): Stream<RequestInput> => {\n    const collateral = Stream.periodic(10000).mapTo(getCollateral()).startWith(getCollateral());\n    const positions = Stream.periodic(3000).mapTo(getPositions()).startWith(getPositions());\n    const state = Stream.periodic(3000).mapTo(getState()).startWith(getState());\n\n    const buy = actions.onClickBuyButton$\n        .compose(sampleCombine(state$))\n        .map(([_, state]) => marketOrder(state.size, \"BUY\"));\n\n    const sell = actions.onClickSellButton$\n        .compose(sampleCombine(state$))\n        .map(([_, state]) => marketOrder(state.size, \"SELL\"));\n\n    const clear = actions.onClickClearButton$\n        .compose(sampleCombine(state$))\n        .map(([_, state]) => marketOrder(state.position.size, state.position.side === \"BUY\" ? \"SELL\" : \"BUY\"));\n\n    return Stream.merge(collateral, positions, buy, sell, clear, state);\n};\n","import hash = require('hash.js');\nimport {RequestInput} from '@cycle/http';\n\nexport const getState = (): RequestInput =>\n    requestInput(\"status\", \"/v1/getboardstate\", \"GET\");\n\nexport const getCollateral = (): RequestInput =>\n    requestInput(\"collateral\", \"/v1/me/getcollateral\", \"GET\");\n\nexport const getPositions = (): RequestInput =>\n    requestInput(\"positions\", \"/v1/me/getpositions\", \"GET\");\n\nexport const marketOrder = (size: number, side: string): RequestInput => {\n    const json = {\n        \"product_code\": \"FX_BTC_JPY\",\n        \"child_order_type\": \"MARKET\",\n        \"side\": side,\n        \"size\": Math.abs(size)\n    };\n    return requestInput(\"order\", \"/v1/me/sendchildorder\", \"POST\", json);\n};\n\nconst requestInput = (category: string, path: string, method: string, json?: object) => {\n    const [key, secret] = getApiKeys();\n\n    const url = `https://api.bitflyer.jp${path}`;\n    const query = { product_code: \"FX_BTC_JPY\" };\n    const queryString = `?product_code=FX_BTC_JPY`;\n\n    const send = json ? JSON.stringify(json) : \"\";\n    const timestamp = Date.now().toString();\n\n    const headers = {\n        \"ACCESS-KEY\": key,\n        \"ACCESS-TIMESTAMP\": timestamp,\n        \"ACCESS-SIGN\": signature(key, secret, url, method, timestamp, send, path, queryString),\n        \"Content-Type\": \"application/json\"\n    };\n\n    return { category, url, method, headers, send, query };\n};\n\nconst getApiKeys = (): string[] => {\n    return [localStorage[\"api-key\"], localStorage[\"api-secret\"]];\n};\n\nconst signature = (\n    key: string,\n    secret: string,\n    url: string,\n    method: string,\n    timestamp: string,\n    send: string,\n    path: string,\n    query: string\n): string => {\n    const text = timestamp + method + path + query + send;\n    return hash.hmac(hash.sha256, secret).update(text).digest('hex');\n};\n","import {button, div, h3, input, p, span, hr, h4} from \"@cycle/dom\";\nimport Stream from \"xstream\";\nimport {State} from \"./model\";\n\nexport const view = (state$: Stream<State>) =>\n    state$.map(state =>\n        div(\".trade\", [\n            div(\".summary\", [\n                h3(\".title\", \"Summary\"),\n                div(\".current-price\", [\n                    span(\".label\", \"Current price\"),\n                    span(\".number\", state.currentPrice.toLocaleString()),\n                    span(\".unit\", \"JPY\")\n                ]),\n                div(\".position\", [\n                    span(\".label\", \"Position\"),\n                    span(\".number\", state.position.toString())\n                ]),\n                div(\".position-diff\", [\n                    span(\".label\", \"Position difference\"),\n                    span(profitDifferenceClass(state), state.position.toDiffString(state.currentPrice)),\n                    span(\".unit\", \"JPY\")\n                ]),\n                div(\".profit\", [\n                    span(\".label\", \"Profit / Loss\"),\n                    span(profitClass(state), state.position.toProfitString(state.currentPrice)),\n                    span(\".unit\", \"JPY\")\n                ]),\n                div(\".collateral\", [\n                    span(\".label\", \"Collateral\"),\n                    span(\".number\", collateralString(state)),\n                    span(\".unit\", \"JPY\")\n                ]),\n                hr(),\n                div(\".market-state\", [\n                    span(\".label\", \"Market state\"),\n                    span(healthClass(state.marketState.health), state.marketState.health)\n                ]),\n                div(\".board-state\", [\n                    span(\".label\", \"Board state\"),\n                    span(healthClass(state.marketState.state), state.marketState.state),\n                ]),\n            ]),\n            div(\".order\", [\n                h3(\".title\", \"Order\"),\n                hr(),\n                h4(\".sub-title\", \"Size\"),\n                div(\".size\", [\n                    input(\"#size-input\", { attrs: { value: state.size }}),\n                ]),\n                hr(),\n                h4(\".sub-title\", \"Market\"),\n                div(\".order-buttons\", [\n                    button(\".sell-button\", { attrs: { disabled: state.isOrdering } }, \"Sell\"),\n                    button(\".buy-button\", { attrs: { disabled: state.isOrdering } },\"Buy\")\n                ]),\n                hr(),\n                h4(\".sub-title\", \"Clear position\"),\n                div(\".order-buttons\", [\n                    button(\".clear-button\", { attrs: { disabled: state.isOrdering } }, \"Clear\"),\n                ]),\n            ])\n        ])\n    );\n\nconst collateralString = (state): string => {\n    if (!state.position.price) return state.collateral.toLocaleString();\n    const profit = state.position.profit(state.currentPrice);\n    return (state.collateral + profit).toLocaleString();\n};\n\nconst profitClass = (state): string => {\n    if (!state.position.price) return \".number\";\n    if (state.position.side === \"BUY\") {\n        return state.currentPrice - state.position.price >= 0.0 ? \".number.plus\" : \".number.minus\";\n    } else {\n        return state.currentPrice - state.position.price >= 0.0 ? \".number.minus\" : \".number.plus\";\n    }\n};\n\nconst profitDifferenceClass = (state): string => {\n    if (!state.position.price) return \".number\";\n    return state.currentPrice - state.position.price >= 0.0 ? \".number.plus\" : \".number.minus\";\n};\n\nconst healthClass = (health: string): string => {\n    if (health === \"NORMAL\" || health === \"RUNNING\") {\n        return \".health.good\";\n    } else {\n        return \".health.bad\";\n    }\n};\n","import {DOMSource, VNode} from \"@cycle/dom\";\nimport {HTTPSource, RequestInput} from \"@cycle/http\";\nimport {Reducer, StateSource} from \"cycle-onionify\";\nimport {HistoryAction, RouterSource} from 'cyclic-router';\nimport Stream from \"xstream\";\nimport {model} from \"./model\";\nimport {StorageRequest, StorageSource} from '@cycle/storage';\nimport {view} from './view';\nimport {intent} from './intent';\n\nexport interface Sources {\n    DOM: DOMSource;\n    HTTP: HTTPSource;\n    onion: StateSource<object>;\n    router: RouterSource;\n    storage: StorageSource;\n}\n\nexport interface Sinks {\n    DOM: Stream<VNode>;\n    HTTP: Stream<RequestInput|null>;\n    onion: Stream<Reducer<object>>;\n    router: Stream<HistoryAction>;\n    storage: Stream<StorageRequest>;\n}\n\nexport const Setting = (sources: Sources): Sinks => {\n    const actions = intent(sources);\n    const reducer$ = model(actions);\n    const view$ = view(sources.onion.state$);\n    const storage$ = Stream.merge(\n        sources.onion.state$.map(state => ({ key: \"api-key\", value: state.apiKey})),\n        sources.onion.state$.map(state => ({ key: \"api-secret\", value: state.apiSecret})),\n    );\n\n    return {\n        DOM: view$,\n        HTTP: Stream.empty(),\n        onion: reducer$,\n        router: Stream.empty(),\n        storage: storage$\n    }\n};\n","import {Reducer} from \"cycle-onionify\";\nimport Stream from \"xstream\";\nimport {Actions} from \"./intent\";\n\nexport interface State {\n    apiKey: string;\n    apiSecret: string;\n}\n\nconst defaultState: State = {\n    apiKey: \"\",\n    apiSecret: \"\"\n};\n\nexport const model = (actions: Actions): Stream<Reducer<State>> => {\n    const defaultReducer$ = Stream.of((state: State) => typeof state === \"undefined\" ? defaultState : state);\n\n    const apiKeyReducer$ = Stream.merge(actions.onApiKeyLoaded$, actions.onApiKeyInputChanged$)\n        .map(apiKey => (state: State) => ({ ...state, apiKey }));\n\n    const apiSecretReducer$ = Stream.merge(actions.onApiSecretLoaded$, actions.onApiSecretInputChanged$)\n        .map(apiSecret => (state: State) => ({ ...state, apiSecret }));\n\n    return Stream.merge(\n        defaultReducer$,\n        apiKeyReducer$,\n        apiSecretReducer$\n    );\n};\n","import {div, h3, input, label, VNode} from \"@cycle/dom\";\nimport Stream from \"xstream\";\nimport {State} from \"./model\";\n\nexport const view = (state$: Stream<State>): Stream<VNode> =>\n    state$.map(state =>\n        div(\".setting\", [\n            h3(\".title\", \"Setting\"),\n            div(\".api-key\", [\n                label({ attrs: { for: \"api-key-input\" } }, \"API Key\"),\n                input(\"#api-key-input\", { props: { type: \"text\" }, attrs: { value: state.apiKey } })\n            ]),\n            div(\".api-secret\", [\n                label({ attrs: { for: \"api-secret-input\" } }, \"API Secret\"),\n                input(\"#api-secret-input\", { props: { type: \"text\" }, attrs: { value: state.apiSecret } }),\n            ])\n        ])\n    );\n","import {Sources} from \"./index\";\nimport Stream from \"xstream\";\n\nexport interface Actions {\n    onApiKeyLoaded$: Stream<string>;\n    onApiSecretLoaded$: Stream<string>;\n    onApiKeyInputChanged$: Stream<string>;\n    onApiSecretInputChanged$: Stream<string>;\n}\n\nexport const intent = (sources: Sources): Actions => {\n    const onApiKeyLoaded$ = sources.storage.local.getItem(\"api-key\")\n        .filter(apiKey => apiKey && apiKey !== \"\")\n        .take(1);\n\n    const onApiSecretLoaded$ = sources.storage.local.getItem(\"api-secret\")\n        .filter(apiSecret => apiSecret && apiSecret !== \"\")\n        .take(1);\n\n    const onApiKeyInputChanged$ = sources.DOM.select(\"#api-key-input\")\n        .events(\"keyup\")\n        .map(event => event.target as HTMLInputElement)\n        .map(element => element.value);\n\n    const onApiSecretInputChanged$ = sources.DOM.select(\"#api-secret-input\")\n        .events(\"keyup\")\n        .map(event => event.target as HTMLInputElement)\n        .map(element => element.value);\n\n    return {\n        onApiKeyLoaded$,\n        onApiSecretLoaded$,\n        onApiKeyInputChanged$,\n        onApiSecretInputChanged$\n    }\n};\n","import Pubnub = require(\"pubnub\");\nimport Stream from \"xstream\";\n\nexport const makePubnubDriver = () => (): PubnubSource => {\n    const subscribeKey = \"sub-c-52a9ab50-291b-11e5-baaa-0619f8945a4f\";\n    return new PubnubSource(new Pubnub({ subscribeKey }));\n};\n\nexport class PubnubSource {\n    public boardSnapshot$ = Stream.create();\n    public board$ = Stream.create();\n    public ticker$ = Stream.create();\n    public execution$ = Stream.create();\n\n    private client: Pubnub;\n\n    constructor(client: Pubnub) {\n        this.client = client;\n\n        client.addListener({\n            message: (message) => {\n                if (message.channel === \"lightning_board_snapshot_FX_BTC_JPY\") {\n                    this.boardSnapshot$.shamefullySendNext(message.message);\n                } else if (message.channel === \"lightning_board_FX_BTC_JPY\") {\n                    this.board$.shamefullySendNext(message.message);\n                } else if (message.channel === \"lightning_ticker_FX_BTC_JPY\") {\n                    this.ticker$.shamefullySendNext(message.message);\n                } else if (message.channel === \"lightning_executions_FX_BTC_JPY\") {\n                    message.message.forEach(message => this.execution$.shamefullySendNext(message));\n                }\n            },\n            presence: (presence) => undefined,\n            status: (status) => undefined\n        });\n\n        client.subscribe({\n            channels: [\n                // \"lightning_board_snapshot_FX_BTC_JPY\",\n                // \"lightning_board_FX_BTC_JPY\",\n                // \"lightning_ticker_FX_BTC_JPY\",\n                \"lightning_executions_FX_BTC_JPY\"\n            ]\n        })\n    }\n}\n"]}